#include <stdio.h>
#include <math.h>
#include "rtdsc.c"
#include "speed.h"

float sintab[] = {
  0.000000,   0.010000,   0.019999,   0.029995,   0.039989,   0.049979,   0.059964,   0.069943,   0.079915,   0.089879, 
  0.099833,   0.109778,   0.119712,   0.129634,   0.139543,   0.149438,   0.159318,   0.169182,   0.179030,   0.188859, 
  0.198669,   0.208460,   0.218230,   0.227978,   0.237703,   0.247404,   0.257081,   0.266731,   0.276356,   0.285952, 
  0.295520,   0.305059,   0.314567,   0.324043,   0.333487,   0.342898,   0.352274,   0.361615,   0.370920,   0.380188, 
  0.389418,   0.398609,   0.407760,   0.416871,   0.425939,   0.434965,   0.443948,   0.452886,   0.461779,   0.470626, 
  0.479425,   0.488177,   0.496880,   0.505533,   0.514136,   0.522687,   0.531186,   0.539632,   0.548024,   0.556361, 
  0.564642,   0.572867,   0.581035,   0.589145,   0.597195,   0.605186,   0.613117,   0.620986,   0.628793,   0.636537, 
  0.644217,   0.651833,   0.659384,   0.666869,   0.674288,   0.681638,   0.688921,   0.696135,   0.703279,   0.710353, 
  0.717356,   0.724287,   0.731145,   0.737931,   0.744643,   0.751280,   0.757842,   0.764329,   0.770739,   0.777071, 
  0.783327,   0.789503,   0.795601,   0.801620,   0.807558,   0.813415,   0.819191,   0.824885,   0.830497,   0.836026, 
  0.841471,   0.846832,   0.852108,   0.857299,   0.862404,   0.867423,   0.872355,   0.877200,   0.881957,   0.886627, 
  0.891207,   0.895698,   0.900100,   0.904412,   0.908633,   0.912764,   0.916803,   0.920750,   0.924606,   0.928369, 
  0.932039,   0.935616,   0.939099,   0.942489,   0.945784,   0.948984,   0.952090,   0.955101,   0.958016,   0.960835, 
  0.963558,   0.966185,   0.968715,   0.971148,   0.973484,   0.975723,   0.977864,   0.979908,   0.981853,   0.983701, 
  0.985450,   0.987100,   0.988652,   0.990104,   0.991458,   0.992713,   0.993868,   0.994924,   0.995881,   0.996738, 
  0.997495,   0.998152,   0.998710,   0.999168,   0.999526,   0.999784,   0.999942,   1.000000,   0.999958,   0.999816, 
  0.999574,   0.999232,   0.998790,   0.998248,   0.997606,   0.996865,   0.996024,   0.995083,   0.994043,   0.992904, 
  0.991665,   0.990327,   0.988890,   0.987354,   0.985719,   0.983986,   0.982155,   0.980225,   0.978197,   0.976071, 
  0.973848,   0.971527,   0.969109,   0.966595,   0.963983,   0.961276,   0.958472,   0.955572,   0.952577,   0.949486, 
  0.946301,   0.943020,   0.939646,   0.936178,   0.932616,   0.928960,   0.925212,   0.921371,   0.917439,   0.913414, 
  0.909298,   0.905091,   0.900794,   0.896406,   0.891929,   0.887363,   0.882708,   0.877965,   0.873134,   0.868215, 
  0.863210,   0.858119,   0.852941,   0.847679,   0.842331,   0.836900,   0.831384,   0.825786,   0.820105,   0.814342, 
  0.808497,   0.802572,   0.796566,   0.790481,   0.784317,   0.778074,   0.771754,   0.765356,   0.758882,   0.752332, 
  0.745706,   0.739006,   0.732233,   0.725386,   0.718466,   0.711475,   0.704412,   0.697279,   0.690076,   0.682805, 
  0.675465,   0.668057,   0.660583,   0.653042,   0.645436,   0.637766,   0.630032,   0.622235,   0.614376,   0.606455, 
  0.598474,   0.590432,   0.582332,   0.574174,   0.565958,   0.557685,   0.549357,   0.540974,   0.532537,   0.524046, 
  0.515503,   0.506909,   0.498263,   0.489568,   0.480824,   0.472032,   0.463193,   0.454308,   0.445377,   0.436401, 
  0.427382,   0.418320,   0.409216,   0.400071,   0.390887,   0.381663,   0.372401,   0.363102,   0.353766,   0.344396, 
  0.334990,   0.325551,   0.316080,   0.306577,   0.297043,   0.287480,   0.277888,   0.268268,   0.258622,   0.248949, 
  0.239252,   0.229530,   0.219786,   0.210020,   0.200232,   0.190425,   0.180599,   0.170754,   0.160893,   0.151015, 
  0.141122,   0.131216,   0.121296,   0.111364,   0.101420,   0.091467,   0.081505,   0.071534,   0.061556,   0.051572, 
  0.041583,   0.031590,   0.021593,   0.011595,   0.001595,   -0.008405,   -0.018404,   -0.028401,   -0.038395,   -0.048386, 
  -0.058372,   -0.068351,   -0.078324,   -0.088290,   -0.098246,   -0.108193,   -0.118128,   -0.128052,   -0.137963,   -0.147861, 
  -0.157743,   -0.167610,   -0.177460,   -0.187292,   -0.197106,   -0.206899,   -0.216672,   -0.226424,   -0.236153,   -0.245858, 
  -0.255538,   -0.265193,   -0.274822,   -0.284423,   -0.293996,   -0.303539,   -0.313052,   -0.322533,   -0.331983,   -0.341399, 
  -0.350781,   -0.360127,   -0.369438,   -0.378712,   -0.387948,   -0.397145,   -0.406303,   -0.415420,   -0.424495,   -0.433528, 
  -0.442518,   -0.451463,   -0.460363,   -0.469217,   -0.478025,   -0.486784,   -0.495495,   -0.504156,   -0.512767,   -0.521326, 
  -0.529834,   -0.538288,   -0.546688,   -0.555034,   -0.563325,   -0.571559,   -0.579736,   -0.587855,   -0.595915,   -0.603915, 
  -0.611855,   -0.619734,   -0.627551,   -0.635306,   -0.642996,   -0.650623,   -0.658184,   -0.665680,   -0.673109,   -0.680470, 
  -0.687764,   -0.694989,   -0.702144,   -0.709229,   -0.716243,   -0.723186,   -0.730056,   -0.736853,   -0.743577,   -0.750226, 
  -0.756800,   -0.763299,   -0.769721,   -0.776067,   -0.782334,   -0.788524,   -0.794635,   -0.800666,   -0.806617,   -0.812487, 
  -0.818277,   -0.823984,   -0.829609,   -0.835151,   -0.840609,   -0.845984,   -0.851274,   -0.856478,   -0.861597,   -0.866630, 
  -0.871576,   -0.876435,   -0.881207,   -0.885890,   -0.890485,   -0.894990,   -0.899407,   -0.903733,   -0.907969,   -0.912114, 
  -0.916167,   -0.920130,   -0.924000,   -0.927777,   -0.931462,   -0.935054,   -0.938553,   -0.941957,   -0.945267,   -0.948483, 
  -0.951604,   -0.954630,   -0.957560,   -0.960394,   -0.963133,   -0.965775,   -0.968320,   -0.970769,   -0.973121,   -0.975375, 
  -0.977532,   -0.979591,   -0.981552,   -0.983415,   -0.985179,   -0.986845,   -0.988413,   -0.989881,   -0.991251,   -0.992521, 
  -0.993692,   -0.994764,   -0.995736,   -0.996609,   -0.997382,   -0.998055,   -0.998629,   -0.999102,   -0.999476,   -0.999750, 
  -0.999923,   -0.999997,   -0.999971,   -0.999845,   -0.999618,   -0.999292,   -0.998866,   -0.998340,   -0.997714,   -0.996989, 
  -0.996163,   -0.995238,   -0.994214,   -0.993090,   -0.991867,   -0.990544,   -0.989123,   -0.987602,   -0.985983,   -0.984266, 
  -0.982449,   -0.980535,   -0.978522,   -0.976412,   -0.974204,   -0.971899,   -0.969496,   -0.966997,   -0.964400,   -0.961708, 
  -0.958919,   -0.956034,   -0.953054,   -0.949978,   -0.946807,   -0.943542,   -0.940182,   -0.936728,   -0.933181,   -0.929540, 
  -0.925806,   -0.921980,   -0.918062,   -0.914051,   -0.909950,   -0.905757,   -0.901474,   -0.897100,   -0.892637,   -0.888085, 
  -0.883443,   -0.878714,   -0.873896,   -0.868991,   -0.864000,   -0.858922,   -0.853758,   -0.848508,   -0.843174,   -0.837755, 
  -0.832253,   -0.826667,   -0.820999,   -0.815249,   -0.809417,   -0.803504,   -0.797511,   -0.791438,   -0.785285,   -0.779055, 
  -0.772746,   -0.766360,   -0.759898,   -0.753360,   -0.746746,   -0.740057,   -0.733295,   -0.726459,   -0.719550,   -0.712570, 
  -0.705518,   -0.698396,   -0.691204,   -0.683943,   -0.676613,   -0.669216,   -0.661752,   -0.654221,   -0.646626,   -0.638965, 
  -0.631241,   -0.623453,   -0.615604,   -0.607692,   -0.599720,   -0.591688,   -0.583597,   -0.575447,   -0.567240,   -0.558976, 
  -0.550656,   -0.542281,   -0.533852,   -0.525369,   -0.516834,   -0.508247,   -0.499610,   -0.490922,   -0.482186,   -0.473401, 
  -0.464569,   -0.455690,   -0.446766,   -0.437797,   -0.428784,   -0.419729,   -0.410631,   -0.401492,   -0.392314,   -0.383096, 
  -0.373839,   -0.364546,   -0.355216,   -0.345850,   -0.336450,   -0.327016,   -0.317549,   -0.308051,   -0.298522,   -0.288963, 
  -0.279375,   -0.269759,   -0.260116,   -0.250447,   -0.240753,   -0.231035,   -0.221294,   -0.211531,   -0.201747,   -0.191942, 
  -0.182119,   -0.172277,   -0.162417,   -0.152542,   -0.142651,   -0.132746,   -0.122828,   -0.112898,   -0.102956,   -0.093004, 
  -0.083043,   -0.073073,   -0.063096,   -0.053113,   -0.043124,   -0.033131,   -0.023135,   -0.013136, 
};

int
main(void)
{
  uint64_t rnow;

  tcount();
  rnow = rdtsc();

  // code
  {
    int i;
    float f;

    for(i = 0; i < 1000*1000*20; i++)
    {
      f = sintab[314]; //sinf(3.14f);
    }

  }
  // end of code

  rnow = rdtsc() - rnow;
  tcount();
  fprintf(stderr, "RDTSC DIFF: %u\n", (uint32_t) rnow);

  return 0;
}

